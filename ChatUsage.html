<html>
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>RTCStar</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="description">
    <meta content="elemind.com" name="author">
    <link href="./About_files/style.css" rel="stylesheet">


    <script src="./About_files/modernizr.min.js" style=""></script>

</head>
<body class="about" data-spy="scroll" data-target=".documentation-nav">
    <div class="container">
        <div class="row">

            <!-- .................................... $header .................................... -->
            <header class="span3">
                <div class="affix">
                    <div class="navbar span3">
                        <div class="navbar-inner">
                            <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
                                <i class="icon-reorder"></i>
                            </a>
                            <a class="brand span2" href="index.html">
                                <img alt="" src="./img/logo.png">
                            </a>
                            </a>
                            <nav class="nav-collapse collapse">
                                <ul class="nav">
                                    <li class="nav-home "><a href="index.html">Home</a></li>
                                   
                                    <li class="dropdown nav-portfolio">
                                        <a class="dropdown-toggle" data-toggle="dropdown" href="./About_files/About.html">
                                            Usage example
                                            <b class="caret"></b>
                                        </a>
                                        <ul class="dropdown-menu">
                                            <li class="nav-portfolio-2 active"><a href="ChatUsage.html">Chat tutorial</a></li>
                                        </ul>
                                    </li>
                                    
                                    <li class="dropdown nav-portfolio">
                                        <a class="dropdown-toggle" data-toggle="dropdown" href="./About_files/About.html">
                                            Demo
                                            <b class="caret"></b>
                                        </a>
                                        <ul class="dropdown-menu">
                                            <li class="nav-portfolio-2 "><a href="ChatDemo.html">Chat </a></li>
                                        </ul>
                                    </li>
                                    
                                    <li class="nav-home"><a href="API.html">API</a></li>

                                </ul>
                            </nav>
                        </div><!-- /navbar-inner -->
                    </div><!-- /navbar -->
                </div><!-- /affix -->
            </header>

            <div class="main span9">

    <!-- .................................... $About .................................... -->
    <section class="section-content section-about" id="section-about">
        <h2 class="section-title">
            Chat server/client example
            <small style="text-transform:none">
                Host of the chat will create both the chat server and chat client. </br>
                The rest of the users only create a chat client.
            </small>

        </h2>

        <h3 class="section-title">
            Setting up Client
            <small> </small>  
            <precode>       
                var ChatWidgetClient = function(rtcStarClient){<br>
                    <span style="padding-left: 20px; display:block">
                    var delegate;<br>
                    rtcStarClient.onClientEvent('Open', openHandler);<br>
                    rtcStarClient.onMessage('Chat', chatHandler);   //  Register listener to Chat<br><br>

                    //  To delegate task of updating the view<br>
                    this.setdelegate = function(d){<br>
                        <span style="padding-left: 20px; display:block">
                        delegate = d;<br>
                        </span>
                    }<br><br>
                    
                    //  Send button on html<br>
                    this.sendchat = function(text){<br>
                        <span style="padding-left: 20px; display:block">
                        var message = new Object();<br>
                        message.type = 'Chat';<br>
                        message.text = text;<br>
                        message.subType = 'NewChat';<br><br>

                        rtcStarClient.request(message);<br>
                        </span>
                    }<br><br>

                    //  When client is started<br>
                    function openHandler(peerId){<br>
                        <span style="padding-left: 20px; display:block">
                        if (delegate != undefined)<br>
                            <span style="padding-left: 20px; display:block">
                            delegate.onOpen(peerId);<br>
                            </span>
                        </span>
                    }<br><br>
                    
                    //  When received a chat message<br>
                    function chatHandler(message){<br>
                        <span style="padding-left: 20px; display:block">
                        if (delegate != undefined)<br>
                            <span style="padding-left: 20px; display:block">
                            delegate.onMessage(message);<br>
                            </span>
                        </span>
                    }<br>
                    </span>
                }<br>
            </precode>

            Client Sending Server
            <precode>
                
                var ChatWidgetServer = function(rtcStarServer){<br><br>
                    <span style="padding-left: 20px; display:block">
                    var history;<br>
                    rtcStarServer.onServerEvent('Open', init);<br>
                    rtcStarServer.onServerEvent('ClientEnter', initClient);<br>
                    rtcStarServer.onRequest('Chat', newChat);   //  Listen to Chat requests<br><br>
                    
                    //  When server starts<br>
                    function init(serverId){<br>
                        <span style="padding-left: 20px; display:block">
                        history = [];<br>
                        </span><br>
                    }<br><br>

                    //  When a new user enters, we send the chat history<br>
                    function initClient(peerId){<br>
                        <span style="padding-left: 20px; display:block">
                        var message = new Object();<br>
                        message.type = 'Chat';<br>
                        message.subType = 'Init';<br>
                        message.data = history;<br>
                        rtcStarServer.send(peerId, message);<br>
                        </span>
                    }<br><br>
                    
                    //  When receiving a new chat, we store the message and broadcast it<br>
                    function newChat(message){<br>
                        <span style="padding-left: 20px; display:block">
                        //storing history of chat <br>
                        history.push(message);<br>
                        rtcStarServer.broadcast(message);<br>
                        </span>
                    }<br><br>
                    </span>
                }<br>

            </precode>
        </h3> 



    </section>
            </div><!-- /main span9 -->

        </div><!-- /row -->
    </div><!-- /container -->

    <!-- .................................... $scripts .................................... -->
    <script src="./About_files/jquery.min.js"></script>
     <!--<script src="./About_files/js"></script>
    <script src="./About_files/jquery.ui.map.min.js"></script> -->
    <script src="./About_files/bootstrap.min.js"></script>
    <!--<script src="./About_files/jquery.fancybox.min.js"></script>
    <script src="./About_files/jquery.hoverdir.min.js"></script>
    <script src="./About_files/jquery.isotope.min.js"></script>
    <script src="./About_files/jquery.masonry.min.js"></script>
    <script src="./About_files/jquery.fitvids.min.js"></script>
    <script src="./About_files/jquery.flexslider.min.js"></script>
    <script src="./About_files/jquery.imagesloaded.min.js"></script>
    <script src="./About_files/cbpBGSlideshow.min.js"></script>
    <script src="./About_files/script.js"></script> -->

</body></html>